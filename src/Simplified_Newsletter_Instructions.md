# Simplified Newsletter Generation Instructions

These instructions ensure consistent monthly reproduction of the engineering newsletter for a company-wide audience (technical and non-technical staff), with a clear, concise focus on business outcomes. The newsletter features a two-column layout for project cards, a full-width "Quick Wins" section spanning both columns at the bottom with a link in the "In This Issue" section, and a single contextual icon next to project titles.

## Content Tone & Audience

**Audience:** Entire company (technical and non-technical staff).

**Remove:**
- Individual names of team members
- Technical metrics (e.g., story points, ticket numbers, sprint numbers)
- Project codes or IDs (e.g., "R79306", "EBP-110")
- Internal jargon and acronyms without context (e.g., UAT, API, unless explained simply)
- Metadata labels (highlight, update, note, achievement, status, progress)
- Verbose descriptions and process details

**Focus on:**
- Business outcomes and value delivered (e.g., improved user experience, cost savings, efficiency gains)
- Simple, clear, and professional language accessible to all employees
- What was accomplished and its impact on customers, clients, or operations
- Concise, punchy communication

**Bullet points:**
- 2-3 items per project (AI-generated for consistency and conciseness)
- 1 line per item (max 12 words)
- Start with action verbs: Delivered, Improved, Enabled, Completed, Reduced, Enhanced
- Highlight completed work or major milestones with business impact
- Avoid technical details or internal processes
- Generated by AI to ensure quality and consistency

**Examples:**
- ‚úì "Improved user feedback process" (instead of: "Completed 35 UAT tickets with 8 resolved")
- ‚úì "Feature development on track" (instead of: "76 story points in sprint")
- ‚úì "Enhanced system reliability" (instead of: "Fixed JSON parsing for API")

## Input Data

- **JSON Input:** Use a JSON file with a "date" field (e.g., "2025-09-01") and a list of projects with fields: title, status, description (one-liner), updates (array of simplified strings), closing_statement (one-liner), label (optional), and include (boolean). Include only projects where include is true AND label is not 'internal'.
- **Quick Wins Data:** Separate JSON array with title, description (one-liner), and resolutionDate for each win.

## Header

**Title format:** ÔøΩ <Month Year> Engineering Newsletter

Derive month and year from JSON "date", using the next month (e.g., "2025-09-01" ‚Äî "October 2025").

**Icon:** üì¢ (announcement megaphone) for contextual messaging and strategic direction. This may be swapped for a contextual icon based on newsletter content (e.g., üéØ for strategic focus, üöÄ for launches, etc.).

**Styling:**
- Centered, white text (#fff) on blue background (#007bff)
- Font: Arial, 36px, bold
- Padding: 20px
- Border radius: 8px
- Must include `id="top"` for anchor links

## "Priorities & Strategic Direction" Section (Optional)

### Purpose & Audience

This full-width section appears **immediately after the header** and before "In This Issue". It provides **leadership-level context** visible to the entire organization, addressing:
- **What engineering is focusing on** for the current period
- **How priorities align to business needs** (customer impact, operational efficiency, revenue, compliance)
- **Strategic framing** to set expectations and communicate overall direction

This section is particularly important to counter newsletter feedback that updates can feel disconnected from business outcomes or feel like "back office work." It directly answers: *What's our engineering strategy and why?*

### When to Include

- Quarterly strategic shifts
- New business initiatives requiring engineering focus
- Clarification on why certain projects appear in the newsletter (business-driven vs. operational)
- Context to help non-technical staff understand engineering priorities

**Note:** This section is **optional**. If no priorities/context data is provided in the JSON, it does not render.

### Data Input

In the `/preview` JSON response, include an optional `priorities` object (sent by the server based on editorial input):

```json
{
  "date": "2025-09-01",
  "issues": [...],
  "quickWins": [...],
  "priorities": {
    "heading": "Q4 Engineering Focus: Customer Experience & Operational Efficiency",
    "content": "As we enter Q4, our engineering efforts are concentrated on two strategic pillars: (1) delivering customer-facing feature enhancements to improve product adoption and client retention, and (2) optimizing backend systems to reduce operational overhead and improve system reliability. These initiatives directly support company revenue goals and operational cost reduction. Watch this section to see progress on both fronts."
  }
}
```

### Layout & Styling

**Container:**
- Full-width white card (#fff) below header, before "In This Issue"
- Left border: 5px solid blue (#0b79ff) for visual consistency with cards
- Padding: 20px
- Border radius: 8px
- Margin: 16px vertical separation (consistent spacing)

**Heading:**
- Font: Arial, 16px, bold
- Color: Blue (#0b79ff)
- Margin-bottom: 12px
- Action-oriented (e.g., "Strategic Focus for November", "Q4 Priorities", "Why These Projects Matter")

**Content:**
- Font: Arial, 14px
- Color: Dark grey (#333)
- Line height: 1.6
- 2-3 sentences maximum (150-200 words)
- Tone: Professional, strategic, non-technical
- Focus: Business outcomes, alignment, and decision-making rationale

**Optional formatting:**
- If provided in content, support simple markdown or plain text
- Avoid HTML; content should be sanitized and escaped

### Implementation Notes

- **Data source:** Editorial team or engineering leadership provides priorities text for current month via `/preview` endpoint or configuration
- **Rendering:** Conditional in template ‚Äî only render if `prioritiesSection` object is present in mapper output
- **Mapping:** `mapPreviewToTemplate` function checks for `preview.priorities` and includes it in output
- **No automatic generation:** Priorities text is **not** AI-generated; it is provided by leadership as editorial input
- **Outlook compatibility:** Uses same div/inline-CSS structure as cards; no tables or special formatting

## "In This Issue" Section

### Layout & Structure

- **Container:** White background card (#fff) with 20px padding, 8px border radius
- **Section title:** "In This Issue" (24px, blue #007bff, bold, Arial)
- **Layout:** Two-column table (width: 100%) with:
  - Left column: width: 50%, padding-right: 20px, vertical-align: top
  - Right column: width: 50%, padding-left: 20px, vertical-align: top

**Styling:**
- Table: border-collapse: collapse; border-spacing: 0; cellpadding: 0; cellspacing: 0
- Font: Arial, 14px, line-height: 1.6, color #333

### Item Distribution

**Items:** All included project titles plus "Quick Wins" (linked to #quick-wins)

**Distribution:**
- Count total items (projects + "Quick Wins")
- Calculate midpoint: Math.ceil(totalItems / 2)
- Left column: Items 0 to midpoint-1, with "Quick Wins" as the last item
- Right column: Items from midpoint to end
- Example: 13 projects + 1 "Quick Wins" = 14 items ‚Äî Left: 0-6 (7 items, including "Quick Wins"), Right: 7-13 (7 items)

**Item Styling:**
- Each item in a row with 1px solid #f0f0f0 bottom border
- Padding: 4px top and bottom
- Font: Arial, 14px, line-height: 1.6
- **Status-based coloring:**
  - If status === "Done", "Deployed", or "Live in Production": Bold, green #28a745, with '‚úì' prefix, and **link color must also be #28a745**
  - Otherwise: Regular text, color #333, no checkmark, link color #333

**Links:** Each item is an anchor link (href="#project-id") where project-id is the project title in lowercase, spaces replaced with hyphens, special characters removed (e.g., "Client Portal - Phase 1" ‚Äî "client-portal-phase-1", "Bidding 2.2" ‚Äî "bidding-2-2"). "Quick Wins" links to #quick-wins.

## Cards Layout

### Column Distribution

**Layout:** Two-column structure using `<div>` elements with inline styles

**CRITICAL - Use DIVs, not tables for cards:**
- Each card must be a `<div>` with inline styles, NOT a `<table>`
- Tables cause Outlook compatibility issues with spacing
- Use `margin-bottom: 20px` on each card div for spacing between cards

**Distribution:**
- Count total project cards
- Calculate midpoint: Math.ceil(totalCards / 2)
- Left column: Cards 0 to midpoint-1
- Right column: Cards from midpoint to end
- Example: 14 cards ‚Äî Left: 0-6 (7 cards), Right: 7-13 (7 cards)

**Implementation:**
- Outer container: `<table>` with `border-collapse: separate; border-spacing: 20px 0` for column gap
- Each column `<td>` contains all respective card `<div>` elements sequentially
- Do NOT create separate `<tr>` rows for each card
- Do NOT close and reopen `<td>` between cards

### Card Structure

**Container:** `<div>` with inline styles:
- `background: #fff`
- `padding: 20px`
- `border-radius: 8px`
- `border-left: 5px solid [color based on status]`
- `margin-bottom: 20px`
- Left border colors:
  - Green #28a745: Done, Deployed, Live in Production
  - Grey #6c757d: UAT, Final Refinements
  - Blue #0052cc: All others (e.g., In Progress, Testing)

### Card Content Order

Each card contains these elements in order (concise and focused):

1. **Project Title with Icon** (format: `<emoji> <Title> ‚Äî <Status>`)
   - Style: `font-size:18px; color:#0b79ff; font-weight:bold; margin-bottom:12px`

2. **One-Line Summary** (AI-generated, max 15 words)
   - Style: `font-size:14px; color:#333; margin-bottom:12px; font-style:italic`
   - Summarizes business impact and outcomes
   - Example: "Enhanced data accessibility and operational efficiency."

3. **Bullet List** (AI-generated, 2-3 items)
   - `<ul>` Style: `margin:0 0 15px 20px; padding:0; font-size:14px`
   - `<li>` Style: `margin-bottom:8px`
   - Each bullet max 12 words, action-oriented
   - Example:
     - Improved database performance by 40%.
     - Completed review phase successfully.
     - Delivered contacts table for user access.

4. **Closing Statement** (AI-generated)
   - Style: `font-size:14px; color:#333; font-weight:bold; margin-top:10px`
   - Starts with emoji, max 12 words
   - Uplifting and celebratory tone

5. **Back to Top Link**
   - Style: `font-size:14px; font-weight:bold`
   - Link: `<a href="#top" style="color:#0b79ff">Back to Top</a>`

### Dynamic Icon Selection

**IMPORTANT:** Icons should be selected programmatically based on project content, NOT hard-coded.

**Title Icons (next to project title):**

Selection logic:
1. First, check project status:
  - If status is "Done", "Deployed", or "Live in Production" ‚Äî use completion icons
  - If status is "UAT", "Testing", or "Final Refinements" ‚Äî use testing icons
  - Otherwise ‚Äî use in-progress icons

2. Then, match to project domain by searching for keywords in the title:
  - Finance/Payment keywords (discount, payment, billing, invoice, accrual, wallet, revenue): üí≥
  - Communication/Call keywords (call, phone, voice, recording, consent, audio): üìû or üéß
  - Data/Analytics keywords (data, analytics, report, statistics, intel, feasibility): üìä
  - AI/Automation keywords (AI, automation, intelligent, smart, bot): ü§ñ
  - Web/Portal keywords (portal, website, web, client-facing): üåê
  - System/Technical keywords (system, infrastructure, database, migration): ‚öôÔ∏è
  - Planning/Process keywords (planning, process, workflow, recruitment): üìã
  - Testing/Refinement keywords (testing, UAT, refinement): üß™ or üîß
  - Completion keywords (done, deployed, complete, live): üéØ

Icon options by status (examples):
- Completed projects: üéØ, ‚öôÔ∏è, üìû
- Testing projects: üß™, üîß, üìä
- In Progress projects: üìä, üåê, üìã, üîß, ‚öôÔ∏è, ü§ñ, üß†, üéß, üí≥, üí≥

**Section Header Icons:**

Based on project status:
- If status is "Done", "Deployed", or "Live in Production" ‚Äî ‚Ä¢ Key Achievements
- If status is "UAT", "Testing", or "Final Refinements" ‚Äî üß™ Testing Updates
- Otherwise ‚Äî üîÑ Progress Updates

**Closing Statement Icons:**

Search the closing_statement text for keywords and return a suitable icon:
- Completion words (complete, done, finished, ready, delivered, deployed, live): üèÅ or ‚Ä¢
- Launch words (launch, launching, release): üöÄ
- Timing words (soon, scheduled, upcoming, next week, waiting): ‚è≥ or üìÖ
- Progress words (progress, advancing, developing, building): üöß or üìà
- Technical words (technical, development, engineering): üîß or ‚öôÔ∏è
- Goal words (target, goal, milestone, aim): üéØ
- Communication words (communication, feedback, updates): üó£Ô∏è or üìû
- Default (if no keywords match): üöÄ

This ensures icons are selected based on actual project content rather than being manually assigned.

## Quick Wins Section

### Layout

**Container:** Full-width `<div>` after all project cards
- Must be inside a `<tr><td>` that comes after the cards container
- Style: `background:#e6f3fa; padding:30px; border-radius:8px; border:2px solid #007bff`
- Must include `id="quick-wins"` for anchor link

### Content Structure

All content inside Quick Wins uses `<div>` with inline styles:

1. **Centered Title** (format: `‚Äº Quick Wins ‚Äî <Previous Month> Highlights`)
   - Style: `font-family:Arial,sans-serif;font-size:18px;color:#007bff;font-weight:bold;text-align:center;margin-bottom:15px`
   - Derive previous month from JSON "date" (e.g., "2025-09-01" ‚Äî "September")

2. **Centered Intro**
   - Style: `font-family:Arial,sans-serif;font-size:14px;color:#333;text-align:center;margin-bottom:20px`
   - Text: "Small enhancements delivered in [month] to boost performance and usability."

3. **Section Header** (left-aligned: `üîÑ Recent Wins:`)
   - Style: `font-family:Arial,sans-serif;font-size:14px;color:#333;font-weight:bold;margin-bottom:15px`

4. **Bullet List** (format: `**<Item Title>** ‚Äî <Description>`)
   - `<ul>` Style: `margin:0 0 20px 20px; padding:0; font-family:Arial,sans-serif;font-size:14px;color:#333;line-height:1.6`
   - `<li>` Style: `margin-bottom:8px`
   - Show all quick wins, sorted by most recent resolutionDate
   - Each description max 15 words

5. **Closing Statement** (starts with ‚Äº)
   - Style: `font-family:Arial,sans-serif;font-size:14px;color:#333;font-weight:bold;text-align:center;margin-bottom:15px`
   - Example: "‚Äº These quick improvements enhanced user experience and efficiency!"

6. **Centered Back to Top Link**
   - Style: `font-family:Arial,sans-serif;font-size:14px;font-weight:bold;text-align:center`
   - Link: `<a href="#top" style="color:#007bff; text-decoration:none;">Back to Top</a>`

## Technical Styling Requirements

### Outlook Compatibility

**CRITICAL:**
- Use inline CSS only (style="" attributes)
- Use `<table>` for outer layout structure ONLY
- Use `<div>` for all card content (NOT tables)
- The outer container and column structure uses tables, but individual cards are divs
- Set `border-collapse: collapse; border-spacing: 0; cellpadding: 0; cellspacing: 0` on all tables
- For column spacing, use `border-collapse: separate; border-spacing: 20px 0` on the cards container table

### Color Palette

- Primary blue: #007bff
- Success green: #28a745
- Neutral grey: #6c757d
- Progress blue: #0052cc
- Light blue background: #e6f3fa
- Background grey: #f5f5f5
- Text dark: #333
- Border light: #f0f0f0
- White: #fff

### Typography

- Font: Arial, sans-serif (specify on every text element)
- Line height: 1.6 (where specified)
- Header title: 36px
- Section headers: 24px ("In This Issue"), 18px (card titles)
- Body text: 14px

### Spacing

- Main container: max-width: 1200px, margin: 0 auto, padding: 20px, background: #f5f5f5
- Card padding: 20px
- Card margin-bottom: 20px (changed from 30px for better spacing)
- Between major sections: 20px vertical
- Inside cards:
  - Title margin-bottom: 15px
  - Description margin-bottom: 15px
  - Section header: margin-top: 10px, margin-bottom: 10px
  - Bullet list: margin: 0 0 15px 20px
  - Bullet items: margin-bottom: 8px
  - Closing statement: margin-top: 10px, margin-bottom: 15px
  - Back to Top: margin-top: 10px

## Implementation notes (code behavior)

These notes describe how the repository currently implements the instructions. They are authoritative for the generator and server behavior; edit them if you change the code.

- Entry point: open the landing page at `/` and enter `from` and `to` dates (YYYY-MM-DD) ‚Äî the form now submits to `/preview.html` which renders the final newsletter HTML for the requested range.
- Endpoint: `GET /preview.html?from=YYYY-MM-DD&to=YYYY-MM-DD` returns the rendered HTML directly (no separate generator run required). The generator CLI still supports `--input` for local JSON.
- Input compatibility: the mapper accepts the server `/preview` JSON (modern: `issues` array with `key`, `summary`, `status`, `labels`, `comments`, `bullets`, `oneLiner`) and also legacy `items` shape found in older example JSON files. Legacy `heading` values are parsed to extract a human-friendly title and optional status.
- Filtering rules applied programmatically:
  - Projects labeled `internal` are excluded.
  - Only included issues (as determined by the `/preview` logic) are used; the server also enforces date-range inclusion rules.
- Editorial transformations applied by the mapper (automatic):
  - **Bullets:** AI-generated for consistency and clarity. Each bullet is 2-3 words maximum, action-oriented, focused on business impact. Removes metadata labels, technical codes, and team member names automatically. Generates 2-3 bullets per project.
  - **One-liner summary:** AI-generated one-sentence description (max 15 words) summarizing the project's business impact.
  - **Closing statement:** AI-generated uplifting closing sentence (max 12 words) with contextual emoji.
  - **Card summary:** AI-generated high-level overview of business outcomes (max 15 words).
- Visual/TOC rules enforced:
  - Balanced two-column card layout: left column gets `ceil(n/2)` cards, right gets the rest.
  - TOC is split into `tocLeft` and `tocRight` with Quick Wins appended as the last left-column item.
  - Done-like statuses (`Done`, `Deployed`, `Live in Production`, `Released`) are flagged as `done` and rendered with a ‚úì prefix and green link color (#28a745) in the TOC.
  - Card header shows a single badge emoji (computed programmatically) followed by the human-friendly title and the status suffix.
- Icons: icons are chosen dynamically by the mapper using this precedence: provided icon in JSON ‚Üí status-based icon ‚Üí label-based heuristics ‚Üí title/keyword heuristics.
- Quick Wins: rendered full-width at the bottom, centered; TOC includes a link to `#quick-wins` on the left column.
- Outlook considerations: cards are DIVs placed inside a two-column table layout. The template currently uses a small `<style>` block for convenience; if you require strict inline-only CSS for Outlook, I can convert all styles to inline attributes during render.

## Example HTML Structure

```html
<table style="max-width:1200px;margin:0 auto;padding:20px;background:#f5f5f5;border-collapse:collapse;border-spacing:0;" cellpadding="0" cellspacing="0">
  <!-- Header -->
  <tr>
    <td style="background:#007bff;color:#fff;font-family:Arial,sans-serif;font-size:36px;font-weight:bold;padding:20px;border-radius:8px;text-align:center;" id="top">
      üì∞ October 2025 Engineering Newsletter
    </td>
  </tr>
  <tr><td style="padding:20px;"></td></tr>
  
  <!-- In This Issue -->
  <tr>
    <td style="background:#fff;padding:20px;border-radius:8px;">
      <table style="width:100%;border-collapse:collapse;border-spacing:0;" cellpadding="0" cellspacing="0">
        <tr>
          <td colspan="2" style="font-family:Arial,sans-serif;font-size:24px;color:#007bff;font-weight:bold;padding-bottom:10px;">In This Issue</td>
        </tr>
        <tr>
          <td width="50%" style="padding-right:20px;vertical-align:top;">
            <table style="width:100%;border-collapse:collapse;border-spacing:0;" cellpadding="0" cellspacing="0">
              <tr><td style="font-family:Arial,sans-serif;font-size:14px;color:#28a745;font-weight:bold;border-bottom:1px solid #f0f0f0;padding:4px 0;">‚úì <a href="#project-id" style="color:#28a745;text-decoration:none;">Done Project Title</a></td></tr>
              <tr><td style="font-family:Arial,sans-serif;font-size:14px;border-bottom:1px solid #f0f0f0;padding:4px 0;"><a href="#project-id-2" style="color:#333;text-decoration:none;">In Progress Project</a></td></tr>
              <tr><td style="font-family:Arial,sans-serif;font-size:14px;border-bottom:1px solid #f0f0f0;padding:4px 0;"><a href="#quick-wins" style="color:#333;text-decoration:none;">Quick Wins</a></td></tr>
            </table>
          </td>
          <td width="50%" style="padding-left:20px;vertical-align:top;">
            <table style="width:100%;border-collapse:collapse;border-spacing:0;" cellpadding="0" cellspacing="0">
              <tr><td style="font-family:Arial,sans-serif;font-size:14px;border-bottom:1px solid #f0f0f0;padding:4px 0;"><a href="#project-id-3" style="color:#333;text-decoration:none;">Another Project</a></td></tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr><td style="padding:20px;"></td></tr>
  
  <!-- Project Cards Container -->
  <tr>
    <td>
      <table style="width:100%;border-collapse:separate;border-spacing:20px 0;" cellpadding="0" cellspacing="0">
        <tr>
          <!-- LEFT COLUMN -->
          <td width="50%" style="vertical-align:top;">
            
            <!-- Card 1 (DIV, not table) -->
            <div style="background:#fff;padding:20px;border-radius:8px;border-left:5px solid #28a745;margin-bottom:20px;">
              <div style="font-family:Arial,sans-serif;font-size:18px;color:#007bff;font-weight:bold;margin-bottom:15px;">üéØ Project Title ‚Äî Done</div>
              <div style="font-family:Arial,sans-serif;font-size:14px;color:#333;line-height:1.6;margin-bottom:15px;">Business impact description goes here.</div>
              <div style="font-family:Arial,sans-serif;font-size:14px;color:#333;font-weight:bold;margin-top:10px;margin-bottom:10px;">‚Ä¢ Key Achievements:</div>
              <ul style="margin:0 0 15px 20px;padding:0;font-family:Arial,sans-serif;font-size:14px;color:#333;line-height:1.6;">
                <li style="margin-bottom:8px;">Milestone achieved with business value delivered to customers.</li>
                <li style="margin-bottom:8px;">System improvements completed enhancing user experience significantly.</li>
              </ul>
              <div style="font-family:Arial,sans-serif;font-size:14px;color:#333;font-weight:bold;margin-top:10px;margin-bottom:15px;">üèÅ Closing statement with impact and celebration!</div>
              <div style="font-family:Arial,sans-serif;font-size:14px;font-weight:bold;margin-top:10px;"><a href="#top" style="color:#007bff;text-decoration:none;">Back to Top</a></div>
            </div>
            
            <!-- More cards... -->
            
          </td>
          
          <!-- RIGHT COLUMN -->
          <td width="50%" style="vertical-align:top;">
            
            <!-- Card 8 -->
            <div style="background:#fff;padding:20px;border-radius:8px;border-left:5px solid #0052cc;margin-bottom:20px;">
              <!-- Card content... -->
            </div>
            
            <!-- More cards... -->
            
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr><td style="padding:20px;"></td></tr>
  
  <!-- Quick Wins -->
  <tr>
    <td>
      <div id="quick-wins" style="background:#e6f3fa;padding:30px;border-radius:8px;border:2px solid #007bff;">
        <div style="font-family:Arial,sans-serif;font-size:18px;color:#007bff;font-weight:bold;text-align:center;margin-bottom:15px;">‚Äº Quick Wins ‚Äî September Highlights</div>
        <div style="font-family:Arial,sans-serif;font-size:14px;color:#333;text-align:center;margin-bottom:20px;">Small enhancements delivered in September to boost performance and usability.</div>
        <div style="font-family:Arial,sans-serif;font-size:14px;color:#333;font-weight:bold;margin-bottom:15px;">üîÑ Recent Wins:</div>
        <ul style="margin:0 0 20px 20px;padding:0;font-family:Arial,sans-serif;font-size:14px;color:#333;line-height:1.6;">
          <li style="margin-bottom:8px;"><strong>Title</strong> ‚Äî Description of business impact and value.</li>
        </ul>
        <div style="font-family:Arial,sans-serif;font-size:14px;color:#333;font-weight:bold;text-align:center;margin-bottom:15px;">‚Äº These quick improvements enhanced user experience and efficiency!</div>
        <div style="font-family:Arial,sans-serif;font-size:14px;font-weight:bold;text-align:center;"><a href="#top" style="color:#007bff;text-decoration:none;">Back to Top</a></div>
      </div>
    </td>
  </tr>
</table>
```